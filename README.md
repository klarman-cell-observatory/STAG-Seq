STAG-SeqAdvancements in genomics have revolutionized human genetics by uncovering the genetic architecture of disease. However, identifying causal variants and their mechanisms of action remains a challenge for therapeutic translation. Here, we integrate variant editing with simultaneous measurements of genomic DNA and RNA to phenotype variants associated with inborn errors of immunity and autoimmune disease. Sensitive Transcriptomics And Genotyping by sequencing (STAG-seq) enabled high-content variant functionalization in primary human immune cells while controlling for allele-dose effects and editing precision.Accordingly, we systematically defined functions for rare coding variants associated with monogenic diseases of immune dysregulation that impact type II interferon signaling in macrophages, thus defining mechanisms and explaining modes of inheritance. Additionally, we elucidated the function of an autoimmunity-linked pleiotropic noncoding variant by defining its cis-regulatory role in TNRC18 expression in T cells and ensuing trans effects on endogenous retroviral element derepression. Finally, we functionally dissected a credible set of noncoding variants in linkage disequilibrium associated with autoimmunity, implicating a causal variant that increases TCF7 expression in T cells and modulates cell fate decisions skewing memory versus effector status.Collectively, we provide a framework to bridge the gap between genetic associations and functional mechanisms to advance our understanding of disease biology.This repository contains the scripts and functions necessary to process, merge, and analyze this data, allowing for comprehensive insights into cellular heterogeneity.Workflow Overview<p align="center">Fig 1. A brief illustration of the STAG-seq workflow.</p>ðŸ§¬ Data ProcessingHyPR-seq DataTo process your HyPR-seq data, you will need to be in a UGER environment, such as the Broad cluster.Activate your Conda Environment: Edit the scripts/process_hyprseq/python_launcher.sh file to point to your Anaconda environment..~/miniconda3/etc/profile.d/conda.sh
conda activate ~/miniconda3 > activate_output.txt
Run the Processing Script: Execute the following command to process your FASTQ files.sh process_hyprseq/launch_script_v2.sh [FASTQ_PATH] [PROBE_SET_FILE]
This script will generate a count_matrix_f100.txt file, which contains the probe counts for each cell barcode. This matrix can be used to construct a Scanpy or Seurat object for downstream analysis.Tapestri Data and MergingOnce you have the .loom file from the Tapestri pipeline, you can call variants and merge the data with your HyPR-seq results.Use the following command to run the merging script:python merge/merge_hyprseq_and_tapestri_output.py \
    -r example/HyPR_matrix.txt \
    -d example/Tapestri_cells.loom \
    -o example/outs \
    -g germline_mutations.txt
For more information on the script's arguments, you can use the -h flag.ðŸ“Š Analysis Notebooks for Paper FiguresThe notebooks directory contains the Jupyter and R notebooks used to generate the figures for our paper. Each subdirectory corresponds to a specific figure.Figure 1: Sensitivityfig1_e-g.ipynbfig1_h-k.ipynbSTAGseq_10X_Fig1.RmdTHP1_Jurkat_Fig1.RmdFigure 2: Matrix Screenpreprocess_matrix_screen.ipynbmatrix_screen_DE.ipynbmake_quadrant_plot.ipynbFigure 3: DSIFNGanders_version_preprocess_IFNG.ipynbfigure3b_umap.ipynbfigure3c_boxplot.ipynbfigure3d-i_ifng_score.ipynbfigure3k.ipynbfigure3k.RFigure 4: TNRC18preprocess_TNRC18.ipynbmake_figures.ipynbfigure4d.ipynbfigure4fgh.ipynbFigure 5: TCF7fig5_c_efg.ipynb